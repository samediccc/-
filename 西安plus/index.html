<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8B4513">
    <meta name="description" content="西安时空地图 - 探索古代长安与现代西安的时空之旅">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="西安时空">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%238B4513' width='100' height='100'/><text x='50' y='70' font-size='60' text-anchor='middle' fill='%23FFD700'>西</text></svg>">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/timeline.css">
    <title>西安时空地图</title>
</head>
<body>
    <div id="app">
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <button class="nav-open-btn" id="nav-open-btn" title="打开导航">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                        </svg>
                    </button>
                    <h1 class="title">
                        <svg class="title-icon" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="45" fill="none" stroke="#FFD700" stroke-width="3"/>
                            <text x="50" y="65" font-size="40" text-anchor="middle" fill="#FFD700">西</text>
                        </svg>
                        <span>西安时空地图</span>
                    </h1>
                </div>
                <p class="subtitle">穿越千年，见证长安与西安的时空对话</p>
            </div>
        </header>

        <nav class="nav-window">
            <div class="nav-header">
                <button class="nav-toggle" id="nav-toggle">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </button>
                <div class="nav-title">导航中心</div>
                <button class="nav-settings" id="nav-settings">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L5.09 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.04.64.09.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.58 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                    </svg>
                </button>
            </div>
            <div class="nav-content" id="nav-content">
                <div class="nav-section">
                    <h4 class="nav-section-title">快速导航</h4>
                    <div class="nav-grid">
                        <button class="nav-item" data-target="map">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"/>
                            </svg>
                            <span>地图</span>
                        </button>
                        <button class="nav-item" data-target="timeline">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                            </svg>
                            <span>时间轴</span>
                        </button>
                        <button class="nav-item" data-target="landmarks">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                            </svg>
                            <span>地标</span>
                        </button>
                        <button class="nav-item" data-target="stories">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/>
                            </svg>
                            <span>故事</span>
                        </button>
                    </div>
                </div>
                <div class="nav-section">
                    <h4 class="nav-section-title">时代切换</h4>
                    <div class="era-switcher">
                        <button class="era-switch-btn active" data-era="ancient">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            古代长安
                        </button>
                        <button class="era-switch-btn" data-era="modern">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/>
                            </svg>
                            现代西安
                        </button>
                    </div>
                </div>
                <div class="nav-section">
                    <h4 class="nav-section-title">搜索</h4>
                    <div class="search-box">
                        <input type="text" id="nav-search" placeholder="搜索地标、事件...">
                        <button class="search-btn">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="nav-section">
                    <h4 class="nav-section-title">快捷功能</h4>
                    <div class="quick-actions">
                        <button class="quick-action" id="action-fullscreen">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
                            </svg>
                            <span>全屏</span>
                        </button>
                        <button class="quick-action" id="action-reset">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                            </svg>
                            <span>重置</span>
                        </button>
                        <button class="quick-action" id="action-share">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
                            </svg>
                            <span>分享</span>
                        </button>
                        <button class="quick-action" id="action-download">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                            </svg>
                            <span>下载</span>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <div class="nav-overlay" id="nav-overlay"></div>

        <main class="main-container">
            <section class="map-section">
                <div id="map-container" class="map-container">
                    <svg id="map-svg" class="map-svg" viewBox="0 0 800 600" preserveAspectRatio="xMidYMid meet">
                        <defs>
                            <linearGradient id="ancientGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#8B4513;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#D2691E;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="modernGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#1E90FF;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#4169E1;stop-opacity:1" />
                            </linearGradient>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                <feMerge>
                                    <feMergeNode in="coloredBlur"/>
                                    <feMergeNode in="SourceGraphic"/>
                                </feMerge>
                            </filter>
                            <filter id="shadow">
                                <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.3"/>
                            </filter>
                        </defs>
                        <g id="map-background"></g>
                        <g id="map-routes"></g>
                        <g id="map-landmarks"></g>
                        <g id="map-labels"></g>
                    </svg>
                </div>
                <div class="map-controls">
                    <button class="control-btn" id="zoom-in" title="放大">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                    </button>
                    <button class="control-btn" id="zoom-out" title="缩小">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13H5v-2h14v2z"/>
                        </svg>
                    </button>
                    <button class="control-btn" id="reset-view" title="重置视图">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                        </svg>
                    </button>
                </div>
            </section>

            <section class="timeline-section">
                <div class="timeline-header">
                    <h2>时间轴</h2>
                    <div class="era-toggle">
                        <button class="era-btn active" data-era="ancient">古代长安</button>
                        <button class="era-btn" data-era="modern">现代西安</button>
                    </div>
                </div>
                <div id="timeline" class="timeline"></div>
            </section>

            <section class="info-panel">
                <div class="info-header">
                    <h3 id="info-title">选择地标查看详情</h3>
                    <button class="close-btn" id="close-info">×</button>
                </div>
                <div id="info-content" class="info-content">
                    <p>点击地图上的地标，探索西安的历史与文化</p>
                </div>
            </section>

            <section class="story-panel">
                <div class="story-header">
                    <h3>数据故事</h3>
                </div>
                <div id="story-container" class="story-container"></div>
            </section>
        </main>

        <footer class="footer">
            <p>© 2024 西安时空地图 | 纯前端SVG+CSS+ES6实现</p>
        </footer>
    </div>

    <script src="js/data-stories.js"></script>
    <script src="js/map-engine.js"></script>
    <script src="js/main.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
        }
    </script>
</body>
</html>